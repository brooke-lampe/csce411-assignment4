Step D Queries

Relational Database:

depth 2
select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961
depth 3
select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961
depth 4
select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961
depth 5
select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select DISTINCT friendId from friends where friends.personId in (select friendId from friends where personId=1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961) and friendId not in (select friendId from friends where personId=1961) and friendId<>1961



Neo4j:

without indices

DROP INDEX ON :Person(name)
DROP INDEX ON :Person(id, name, state)

with indices

CREATE INDEX ON :Person(name)
CREATE INDEX ON :Person(id, name, state)


depth 2

MATCH (person:Person { name: "Cecilia Thenhaus" })-[:FRIEND_WITH*2..2]->(friend_of_friend:Person)
WHERE NOT ((person)-[:FRIEND_WITH*1..1]->(friend_of_friend))
RETURN DISTINCT friend_of_friend.id

time_without_indices: 22ms
time_with_indices: 1ms


depth 3

MATCH (person:Person { name: "Cecilia Thenhaus" })-[:FRIEND_WITH*3..3]->(friend_of_friend:Person)
WHERE NOT ((person)-[:FRIEND_WITH*1..2]->(friend_of_friend))
RETURN DISTINCT friend_of_friend.id

time_without_indices: 31ms
time_with_indices: 6ms


depth 4

MATCH (person:Person { name: "Cecilia Thenhaus" })-[:FRIEND_WITH*4..4]->(friend_of_friend:Person)
WHERE NOT ((person)-[:FRIEND_WITH*1..3]->(friend_of_friend))
RETURN DISTINCT friend_of_friend.id

time_without_indices: 49ms
time_with_indices: 39ms


depth 5

MATCH (person:Person { name: "Cecilia Thenhaus" })-[:FRIEND_WITH*5..5]->(friend_of_friend:Person)
WHERE NOT ((person)-[:FRIEND_WITH*1..4]->(friend_of_friend))
RETURN DISTINCT friend_of_friend.id

time_without_indices: 204ms
time_with_indices: 227ms